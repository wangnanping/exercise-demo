<!DOCTYPE html>
<html>

<head>
    <title>Post Message 这里主要是实现页面嵌套的firame消息传递</title>
</head>

<body>
    //postmessage 主要实现下面三个问题的跨域数据传递，允许来自不同源的脚本采用异步方式进行有限的通信，可以实现跨文本档、多窗口、跨域消息传递。<br> //1.页面和其打开的新窗口的数据传递
    <br> // 2. 多窗口之间消息传递<br> // 3. 页面与嵌套的iframe消息传递<br>
    <div style="width:200px; float:left; margin-right:200px;border:solid 1px #333;">
        <div id="color">点击iframe改变颜色</div>
    </div>
    <div>
        <iframe id="child" src="file:///C:/Users/Wangnanping/Desktop/github_vue_cli/exercise-demo/postmessage%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E8%B7%A8%E7%AA%97%E5%8F%A3/lslib.html"></iframe>
    </div>

    <script type="text/javascript">
        //postMessage(data,origin)方法接受两个参数
        //data 要传递的数据(任意基本类型的对象),部分浏览器只能处理字符串参数，有时可以用JSON.stringify()对对象进行序列化
        //origin 字符串参数 ，指明目标窗口的源，协议+主机+端口号[+URL]，URL会被忽略，所以可以不写，这个参数是为了安全考虑，postMessage()方法只会将message传递给指定窗口，当然如果愿意也可以建参数设置为"*"，这样可以传递给任意窗口，如果要指定和当前窗口同源的话设置为"/"。
        window.onload = function () {
            // window.frames[0].postMessage('getcolor', '/lslib.html');  //例子
        }
        //例子主要是实现通过点击iframe 改变div color的颜色
        window.addEventListener('message', function (e) { //主页面接收消息 改变颜色
            console.log(e); //打印查看信息  利用这时候的MessageEvent对象判断了一下消息源
            var color = e.data; //e.data 就是传递来的message  
            document.getElementById('color').style.backgroundColor = color;
        }, false);
    </script>
</body>

</html>